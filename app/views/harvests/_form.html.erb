<%= form_for(@harvest) do |f| %>
  <% if @harvest.errors.any? %>
    <div id="error_explanation">
      <h2><%= pluralize(@harvest.errors.count, "error") %> prohibited this harvest from being saved:</h2>
      <ul>
      <% @harvest.errors.full_messages.each do |message| %>
        <li><%= message %></li>
      <% end %>
      </ul>
    </div>
  <% end %>
  <h2>Animal Type</h2>
  <%= f.radio_button :animal_type, value: 1, class: 'form-control' %><%= f.label :turkey %>
  <%= f.radio_button :animal_type, value: 2, class: 'form-control' %> <%= f.label :deer %>
  <%= f.radio_button :animal_type, value: 3, class: 'form-control' %> <%= f.label :moose %>
  <%= f.radio_button :animal_type, value: 4, class: 'form-control' %> <%= f.label :bear %>
  <br>
  <br>
  <h2>Weapon Type</h2>
  <%= f.radio_button :weapon_type, value: 1, class: 'form-control' %> <%= f.label :rifle %>
  <%= f.radio_button :weapon_type, value: 2, class: 'form-control' %> <%= f.label :shotgun %>
  <%= f.radio_button :weapon_type, value: 3, class: 'form-control' %> <%= f.label :bow %>
  <%= f.radio_button :weapon_type, value: 4, class: 'form-control' %> <%= f.label :other %>
  <br>
  <br>
  <%= f.label 'Weight (Optional)' %>
  <%= f.text_field :weight, class: 'form-control' %> 
  <%= f.label 'Details (Optional)' %>
  <%= f.text_field :description, class: 'form-control' %>
  <h2>Plot Your Harvest</h2>
  
  
  <div class="col-md-6">
			<div style="width:100%;height:70%;">
			</div>
			<!-- Text boxes to show lat long values -->
			<div class="col-md-6 pull-left">
				<span>Latitude</span>
				<input type="text" id="latitude" class="form-control">
			</div>
			<div class="input-group col-md-6 pull-left">
				<span class="input-group-addon" >Longitude</span>
				<input type="text" class="form-control" id="longitude">
			</div>

			
		
		</div>		
  <div id="map"></div>

  <br>
  <%= f.label :image %>
  <%= f.file_field :image %>
  <div class="actions">
    <%= f.submit %>
  </div>
<% end %>
<script>
    

var markers = [];
var userLat = <%= @user.latitude %>;
var userLng = <%= @user.longitude %>;

function initialize() {
  var map = new google.maps.Map(document.getElementById('map'), {
    zoom: 9,
    center: { lat: userLat, lng: userLng },
    mapTypeId: 'terrain',
    styles: [
            {
              featureType: 'landscape',
              stylers: [
                { saturation: -50 }
              ]
            },{
              featureType: 'water',
              stylers: [
                { hue: '#174a67' },
                { saturation: 50 },
                { lightness: -80 }
              ]
            },{
              featureType: 'road',
              elementType: 'geometry',
              stylers: [
                { hue: '#00ffee' },
                { saturation: 50 }
              ]
            },{
              featureType: 'poi',
              elementType: 'labels',
              stylers: [
                { visibility: 'off' }
              ]
            }
          ]
  });
  
  // This event listener calls addMarker() when the map is clicked.
  google.maps.event.addListener(map, 'click', function(event) {

    addMarker(event.latLng, map);
    map.panTo(event.latLng);
    var latitude = map.getCenter().lat().toFixed(6);
		var longitude = map.getCenter().lng().toFixed(6);
		document.getElementById("latitude").value = latitude;
		document.getElementById("longitude").value = longitude;
				
  });
}
    
// Adds a marker to the map.
function addMarker(location, map) {
  
  //simply clear out all items from array
  for (var i = 0; i < markers.length; i++) {
      markers[i].setMap(null);
  }
  markers = [];
  
  
  // create draggable marker 
  
  var marker = new google.maps.Marker({
    position: location,
    draggable: true,
    label: "+",
    map: map
  });
  
  //add event to marker object on change
  google.maps.event.addListener(marker, 'dragend', function(event) {
    //alert(event.latLng.lat());
    var latitude = event.latLng.lat().toFixed(6);
		var longitude = event.latLng.lng().toFixed(6);
		document.getElementById("latitude").value = latitude;
		document.getElementById("longitude").value = longitude;
  });

  markers.push(marker);
}

function initMap(){
  initialize();
}

google.maps.event.addDomListener(window, 'load', initialize);

</script>






//